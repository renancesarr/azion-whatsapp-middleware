# US05 — Fallback Seguro

## Escopo
Quando qualquer etapa da pipeline falhar, o HTML **original** deve ser entregue sem modificações. O fallback não tenta recuperar parcialmente; ele simplesmente devolve o input bruto.

## Componentes
1. `safeTry(fn)` → executor protegido que expõe `{ ok, value, error }`.
2. `fallbackReturnOriginalHtml(html)` → devolve `html` byte a byte.
3. `shouldUseFallback(results)` → retorna `true` se qualquer etapa falhou.
4. `orchestrateFallbackDecision(originalHtml, processedHtml, results)` → escolhe entre `processedHtml` e `originalHtml`.

## Fluxo
```
ler HTML → safeTry(identificar CTAs) → safeTry(selecionar nº) → safeTry(selecionar msg)
     → safeTry(construir URL) → safeTry(reescrever elemento) → safeTry(reconstruir HTML)
     → shouldUseFallback(results?) ? HTML original : HTML reescrito
```

## Exemplos
- **Sem falha:** resultado do parser + reescrita → HTML final com CTAs alterados.
- **Com falha (ex.: seleção quebra):** `safeTry` marca `ok=false`, `orchestrateFallbackDecision` devolve o HTML original intacto.

### Artefatos de teste manual
- `tests/test-us05.js` (opcionalmente com argumento `identify`, `selectNumber`, `selectMessage`, `buildUrl`, `rewriteElement`, `rewriteHtml`) imprime os resultados registrados e o HTML final, permitindo simular falhas específicas.
