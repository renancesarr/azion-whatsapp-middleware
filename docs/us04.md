# US04 — Grupos de Contato

## 1. Estrutura da Configuração (T04-001/T04-003)
```js
groups: {
  comercial: {
    numbers: ["+551134567891", "+5511988889123"],
    messages: ["alpha-ignite-pulse", "ember-spire-nova"],
  },
  suporte: {
    numbers: ["+554730019287", "+5547999990123"],
    messages: ["calm-orbit-sage", "azure-balance-halo"],
  },
}
```
- Cada grupo replica a estrutura global (`numbers`, `messages`).
- Campos ausentes herdam da lista global.

## 2. Detecção do Grupo (T04-004/T04-005)
- `identifyWhatsappElements` lê o atributo `data-contact-group` e anexa `group` ao objeto retornado.
- Ausência do atributo → `group: null`.

## 3. Seleção de Números e Mensagens (T04-006 ~ T04-010)
- `getGroupLists(groupName, config)` devolve listas específicas ou globais.
- `selectItem` atualmente usa estratégia randômica (`selection.numbers/messages = "random"`), sem persistir estado entre requisições.
- Fallback: listas globais são usadas quando o grupo é desconhecido.

## 4. Integração no Fluxo (T04-011/T04-012)
- `buildWhatsappUrlForElement` chama `getGroupLists` antes de selecionar número/mensagem.
- `processHtmlForWhatsappCtas` aplica o resultado em cada CTA identificado.

## 5. Validação Manual (T04-013 ~ T04-015)
- Utilizar `tests/us04-test.html` + `tests/test-us04.js` (vide repositório) para visualizar a distribuição randômica entre grupos.
- Confirmar que cada CTA recebe números/mensagens pertencentes ao seu grupo ou às listas globais quando não informado.

## 6. Documentação Final (T04-016)
- Este arquivo formaliza os pontos de extensão e comportamento de fallback para grupos.
