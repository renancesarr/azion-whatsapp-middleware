# US03 — Seleção Dinâmica de Mensagens

## 1. Estrutura da Lista de Mensagens (T03-001/T03-002)
- Local: `config/index.js`, chaves `messages` (globais) e `groups.<nome>.messages` (opcionais).
- Tipo: array de strings simples, cada item já pré-formatado para fácil encoding.
- Restrições: usar apenas caracteres seguros (`a-z`, `-`, números) para evitar surpresas na etapa de URL encoding.
- Exemplo:
```js
messages: [
  "orbital-lynx-river",
  "solar-harbor-lumen",
];
```

## 2. Estratégias Suportadas (T03-004 ~ T03-009)
- Configuração atual: `selection.messages` aceita `"random"` e é o padrão. Estratégias futuras (round-robin/pesos) serão plugadas posteriormente.
- Seleção ocorre em `selectItem(list, strategy, options)` e usa `Math.random` (ou `options.randomFn` quando informado) para definir o índice.

## 3. Encoding da Mensagem (T03-010/T03-011)
- Função: `encodeMessage(message)` encapsula `encodeURIComponent`.
- Entrada: string bruta da configuração.
- Saída: string segura para URL (`orbital-lynx-river` → `orbital-lynx-river`, `olá mundo` → `ol%C3%A1%20mundo`).

## 4. Integração na URL (T03-012/T03-014)
- `buildWhatsappUrlForElement(element, context)` seleciona número + mensagem com base no grupo (quando houver) e monta `https://wa.me/<numero>?text=<mensagemEncodeada>`.
- O contexto (`context.config`) garante que mensagens globais ou específicas de grupo sejam usadas corretamente. Em testes é possível fornecer `context.randomFn` para obter resultados determinísticos.

## 5. Artefatos de Teste Manual (T03-015/T03-017)
- Reutilizamos `tests/us01-test.html` + `tests/test-us01.js` para observar variações.
- Como a estratégia atual é randômica, executar o script múltiplas vezes já exibe combinações diferentes.
