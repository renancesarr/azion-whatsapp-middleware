# US07 — Preservar SEO e Consistência de Conteúdo

## 1. Princípios
- Nunca alterar o conteúdo textual dos CTAs (`innerText`).
- Nunca mudar a tag (ex.: `<a>` continua `<a>`).
- Nenhum atributo existente pode ser removido ou ter valor alterado, exceto `href`.
- A única modificação permitida é inserir/substituir `href`.
- Ordem de atributos não é relevante, mas todos devem permanecer presentes.

## 2. Validações implementadas
1. **Extração de texto interno** (`extractInnerText`) para comparar conteúdo antes/depois.
2. **Comparação textual**: se qualquer caractere diferir → fallback.
3. **Integridade estrutural**: compara tag e atributos (exceto `href`).
4. **Alteração mínima**: garante que somente o `href` mudou.
5. **Validação orquestrada** (`validateSeoPreservation`): executa todas as regras acima antes de aceitar o CTA reescrito.

## 3. Fluxo de SEO no pipeline
```
injectHrefIntoElement → validar texto → validar atributos → validar alteração mínima → substituir elemento
```
Se qualquer etapa falhar, o pipeline marca a stage `seo-validation` com `ok=false` e US05 aplica fallback.

## 4. Testes e QA
- `tests/unit/seo.test.js` cobre as funções puras.
- `tests/integration/seo-validation.test.js` garante fallback quando a validação falha.
- Validação manual (T07-014): executar `tests/test-us05.js` e comparar `originalHtml` / `finalHtml` via `diff` ou ferramenta similar para confirmar que somente o `href` mudou.

## 5. Limites
- O validador assume HTML bem-formado e não tolera múltiplos elementos no snippet (apenas o CTA alvo).
- Outras mutações legítimas (ex.: data-* extras) devem ser tratadas explicitamente antes de ativar o validador.
